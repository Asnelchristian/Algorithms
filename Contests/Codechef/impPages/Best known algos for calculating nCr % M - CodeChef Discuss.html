<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0081)http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Best known algos for calculating nCr % M - CodeChef Discuss</title>
        <meta name="description" content="I have often encountered calculating nCr problems the last one being one of the IIIT-M problems but it probably had weak test cases that got easy solutions AC. The other one https://cs3.interviewstreet.com/challenges/dashboard/#problem/50877a587c389 of codesprint was completey out of my minds and ha">
        <meta name="keywords" content="mathematics,runtime,algorithm,time">
        
        <link rel="canonical" href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/Best known algos for calculating nCr % M - CodeChef Discuss.html">
        <link rel="alternate" type="application/rss+xml" title="RSS" href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?type=rss">

        
        
        <link rel="shortcut icon" href="http://discuss.codechef.com/upfiles/favicon_1.ico">
        <link href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/style.css" rel="stylesheet" type="text/css">
        
        <link href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/custom.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/jquery-ui.css">
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script type="text/javascript" async="" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/atrk.js"></script><script src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/jsapi" type="text/javascript"></script>
        <script type="text/javascript">
        /*<![CDATA[*/
            google.load("jquery", "1.4.2");
            google.load("jqueryui", "1", {autoload:true});

            var i18nLang = 'en';
            var appUrl = 'http://discuss.codechef.com'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: 'tushar_rishav',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script><script src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/jquery.min.js" type="text/javascript"></script><script src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/jquery-ui.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/osqa.main.js"></script>
        
        
        
        
        
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/osqa.question.js"></script>
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/jquery.caret.js"></script>
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/showdown.js"></script>
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/wmd.js"></script>
        <link rel="stylesheet" type="text/css" href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/wmd.css">

        
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/viewbox_min.js"></script>
        <script type="text/javascript" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/youtube.js"></script>
        <link rel="stylesheet" type="text/css" href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/viewbox.css">
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            &lt;style&gt;
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            &lt;/style&gt;
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="http://discuss.codechef.com/opensearch.xml" title="CodeChef Discuss Search">
        
    <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body><div id="MathJax_Message" style="display: none;"></div>
        <div class="wrapper">
        
        <!-- template header.html -->

<script src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/MathJax.js" type="text/javascript"></script>
<style>
.MathJax {
    font-size: 2em;
}
</style>
<script type="text/javascript">

    $(document).ready(function () {
        initSearchBoxValue();
    });

    MathJax.Hub.Config({
        "tex2jax": {
            inlineMath: [['$', '$']],
            multiLine: true
        }
    });

    function initSearchBoxValue()
    {
        var searchKeyword= $("#keywords").val();
            if (searchKeyword=="")
            {
                $("#keywords").val("Search Here...");
            }
   }

    function searchBoxOnBlur(){
        $("#keyword").className="searchInput";
        if ($("#keywords").val()=="")
                $("#keywords").val("Search Here...");
    }

    function searchBoxOnFocus(){
        $("#keyword").className="searchInputFocused";
        if ($("#keywords").val()=="Search Here...")
            $("#keywords").val("");
   }

    function about(){
        if (document.URL=="http://osqa.codechef.local/about/")
        {
            $("")
        }
    }

</script>



 

	<div id="roof">



		<div id="logo">
			<a href="http://discuss.codechef.com/">
				<img src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/site-logo_21.png" title="back to home page" alt="CodeChef Discuss logo">
			</a>
		</div>
	  
		<div id="top">
		     <a href="http://discuss.codechef.com/users/83638/tushar_rishav">tushar_rishav</a> <span class="score" title="1 karma">1</span> <a href="http://discuss.codechef.com/logout/">Log Out</a> 

            <div id="nav">
                <a id="nav_questions" class="on" href="http://discuss.codechef.com/questions/">questions</a><a id="nav_tags" href="http://discuss.codechef.com/tags/">tags</a><a id="nav_users" href="http://discuss.codechef.com/users/">users</a><a id="nav_badges" href="http://discuss.codechef.com/badges/">badges</a><a id="nav_unanswered" href="http://discuss.codechef.com/questions/unanswered/">unanswered</a>
                <a id="horiSeparator">
                </a><a id="nav_ask" href="http://discuss.codechef.com/questions/ask/" class="special">ask a question</a>
                <a id="nav_about" href="http://discuss.codechef.com/about" class="off" onclick="about()">about</a>
                <a id="nav_faq" href="http://discuss.codechef.com/faq">faq</a>

            </div>
		</div>











  </div>

  <div class="clear"></div>
	<div id="searchBar">




        <table id="searchBarTable">
            <tbody><tr>
                <td class="left">
                    CodeChef Discussion
                </td>
                <td class="right">
                    <form action="http://discuss.codechef.com/search/" method="get">
                    <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="937b59130af89f7011b043a36f3c6fe6"></div>
                        <table>
                            <tbody><tr>
                                <td>
                                    <input type="text" class="searchInput" value="" name="q" id="keywords" onfocus="searchBoxOnFocus()" onblur="searchBoxOnBlur()">
                                </td>
                                <td>
                                    <div class="options">
                                        <input id="type-question" type="radio" value="question" name="t" checked="checked"><label for="type-question">questions</label>
                                        <input id="type-tag" type="radio" value="tag" name="t"><label for="type-tag">tags</label>
                                        <input id="type-user" type="radio" value="user" name="t"><label for="type-user">users</label>
                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </form>
                </td>
            </tr>
        </tbody></table>
        <h1 id="separator">
        </h1>
	</div>


	

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1>Best known algos for calculating nCr % M</h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table">
                <tbody><tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-3869-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/3869/up/" rel="nofollow"> </a>
<div id="post-3869-score" class="post-score" title="current number of votes">
    21
</div>
<a id="post-3869-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/3869/down/" rel="nofollow"> </a>
                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)" class="ajax-command favorite-mark " href="http://discuss.codechef.com/mark_favorite/3869/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   23
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have often encountered calculating nCr problems the last one being one of the IIIT-M problems but it probably had weak test cases that got easy solutions AC. The other one <a href="https://cs3.interviewstreet.com/challenges/dashboard/#problem/50877a587c389">https://cs3.interviewstreet.com/challenges/dashboard/#problem/50877a587c389</a> of codesprint was completey out of my minds and hands , I tried the inverse euler , power of p in n! ( I would also like if someone could explain me the theory of this method ) but all went in vain . Anyone who could suggest probably the best algos for cases when nCr is to be calculated with large n and r with and without % M where M is prime/not prime + the above method which I coded but couldn't understand how it was so.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="http://discuss.codechef.com/tags/mathematics/" class="post-tag tag-link-mathematics" title="see questions tagged &#39;mathematics&#39;" rel="tag">mathematics</a>
                                
                                    <a href="http://discuss.codechef.com/tags/runtime/" class="post-tag tag-link-runtime" title="see questions tagged &#39;runtime&#39;" rel="tag">runtime</a>
                                
                                    <a href="http://discuss.codechef.com/tags/algorithm/" class="post-tag tag-link-algorithm" title="see questions tagged &#39;algorithm&#39;" rel="tag">algorithm</a>
                                
                                    <a href="http://discuss.codechef.com/tags/time/" class="post-tag tag-link-time" title="see questions tagged &#39;time&#39;" rel="tag">time</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                
<div class="community-wiki">
        This question is marked "community wiki".
        
    </div>
                            </div>
                            <div class="post-update-info-container">
                                    
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        asked
        <strong>15 Nov '12, 14:45</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/93bba4882428f141c924f8b66131b0c9.JPG" alt="kavishrox&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/2552/kavishrox">kavishrox</a><br>
    <span class="score" title="285 karma">285</span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="17 badges"><span class="silver">●</span><span class="badgecount">17</span></span><span title="19 badges"><span class="bronze">●</span><span class="badgecount">19</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="kavishrox has one accepted answer">5%</span>
    </p>
</div>

    <div class="post-update-info post-update-info-edited">
        <p style="line-height:12px;">
            <a href="http://discuss.codechef.com/revisions/3869/">
                wikified
                <strong>18 Nov '12, 09:51</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            


<div class="comments-container" id="comments-container-3869">
    
</div>
<div id="comment-tools-3869" class="comment-tools">
    
    
</div>
<div id="comment-3869-form-container" class="comment-form-container">
    
</div>
    

                        </div>

                    </td>
                </tr>
            </tbody></table>
            
            
                <hr>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    7 Answers:
                    </div>
                    
<div class="tabsA"><a href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?sort=oldest" title="oldest answers will be shown first">oldest</a><a href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?sort=newest" title="newest answers will be shown first">newest</a><a href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?sort=votes" class="on" title="most voted answers will be shown first">most voted</a></div>

                </div>
                

                
                    <a name="3876"></a>
                    <div id="answer-container-3876" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-3876-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/3876/up/" rel="nofollow"> </a>
<div id="post-3876-score" class="post-score" title="current number of votes">
    90
</div>
<a id="post-3876-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/3876/down/" rel="nofollow"> </a>
                                        


    
      <a class="accept-answer on" title="cyberax has selected this answer as the correct answer" href="http://discuss.codechef.com/accept_answer/3876/" rel="nofollow"> 
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I encountered <sup>n</sup>C<sub>r</sub> for the first time on GCJ 08, Round 3 Problem D .. <a href="http://code.google.com/codejam/contest/32002/dashboard#s=a&a=3">link to analysis</a>.</p>
<p>The first key idea is that of <a href="http://en.wikipedia.org/wiki/Lucas'_theorem">Lucas' Theorem</a>.</p>
<p>Lucas's Theorem reduces <sup>n</sup>C<sub>r</sub> % M to</p>
<p>(<sup>n<sub>0</sub></sup>C<sub>r<sub>0</sub></sub> % M) (<sup>n<sub>1</sub></sup>C<sub>r<sub>1</sub></sub> % M) ... (<sup>n<sub>k</sub></sup>C<sub>r<sub>k</sub></sub> % M)</p>
<p>Where,</p>
<p>(n<sub>k</sub>n<sub>k-1</sub>...n<sub>0</sub>) is the base M representation of n<br>
(r<sub>k</sub>r<sub>k-1</sub>...r<sub>0</sub>) is the base M representation of r</p>
<ul>
<li>Note, if any of the above terms is zero because r<sub>i</sub> &gt; n<sub>i</sub> or any other degeneracy, then the binomial coefficient <sup>n</sup>C<sub>r</sub> % M = 0</li>
</ul>
<p>This means that any of the terms in the expansion of <sup>n<sub>i</sub></sup>C<sub>r<sub>i</sub></sub> is not divisible by M. But this is only half the job done.</p>
<p>Now you have to calculate <sup>n</sup>C<sub>r</sub> % M (ignoring subscripts for brevity) for some 0 ≤ r ≤ n &lt; M</p>
<p>There are no ways around it, but to calculate</p>
<p>[ n! / ( r! (n-r)! ) ] % M</p>
<p>Without loss of generality, we can assume r ≤ n-r</p>
<p>Remember, you can always do the Obvious. Calculate the binomial and then take a modulo. This is mostly not possible because the binomial will be too large to fit into either int or long long int (and Big Int will be too slow)</p>
<p>This can then be simplified by using some clever ideas from Modular Arithmetic.</p>
<ul>
<li>If A*B % M = 1, A and B are <a href="http://en.wikipedia.org/wiki/Modular_multiplicative_inverse">modular multiplicative inverses</a> of each other.</li>
</ul>
<p>For brevity, we say B % M = A<sup>-1</sup> % M</p>
<p>It is not always possible to calculate modular multiplicative inverses. If A and M are not co-prime, finding a B will not be possible.<br>
For example, A = 2, M = 4. You can never find a number B such that 2*B % 4 = 1</p>
<p>Most problems give us a prime M. This means calculating B is always possible for any A &lt; M.<br>
For other problems, look at the decomposition of M. In the codesprint problem you mentioned</p>
<p>142857 = 3<sup>3</sup> * 11 * 13 * 37</p>
<p>You can find the result of <sup>n</sup>C<sub>r</sub> % m for each m = 27, 11, 13, 37. Once you have the answers, you can reconstruct the answer modulo 142857 using <a href="http://en.wikipedia.org/wiki/Chinese_remainder_theorem">Chinese Remainder Theorem</a>. These answers can be found by Naive Methods since, m is small.</p>
<p>I have also seen problems where M is a product of large primes, but <a href="http://en.wikipedia.org/wiki/Square-free_integer">square free</a>. In these cases, you can calculate the answers modulo the primes that M is composed of using modular inverses (a little more about that below), and reconstruct the answer using CRT.</p>
<p>I am yet to see a problem where M is neither, but if it is. I do not know if there is a way to calculate binomial coefficients generally (since you cannot calculate modular inverses, and neither can you brote force). I can dream of a problem where there are powers of small primes, but square-free larger ones for a Number Theory extravaganza.</p>
<p>There is one other way to calculate <sup>n</sup>C<sub>r</sub> for any M which is small enough (say M ≤ 5000) or small n and r (say r ≤ n ≤ 5000) by using the following recursion with memoization</p>
<p><sup>n</sup>C<sub>r</sub> = <sup>n-1</sup>C<sub>r</sub> + <sup>n-1</sup>C<sub>r-1</sub></p>
<p>Since there are no divisions involved (no multiplications too) the answer is easy and precise to calculate even if the actual binomials would be very large.</p>
<p>So, back to calculating</p>
<p>[ n! / ( r! (n-r)! ) ] % M, you can convert it to</p>
<p>n * (n-1) ... * (n-r+1) * r<sup>-1</sup> * (r-1)<sup>-1</sup> ... * 1</p>
<p>Of course, each product is maintained modulo M.</p>
<p>This may be fast enough for problems where M is large and r is small.</p>
<p>But sometimes, n and r can be very large. Fortunately, such problems always have a small enough M :D</p>
<p>The trick is, you pre-calculate factorials, modulo M and pre-calculate inverse factorials, modulo M.</p>
<p>fact[n] = n * fact[n-1] % M<br>
ifact[n] = modular_inverse(n) * ifact[n-1] % M</p>
<p>Modular Multiplicative Inverse for a prime M is in fact very simple. From <a href="http://en.wikipedia.org/wiki/Fermat's_little_theorem">Fermat's Little Theorem</a></p>
<p>A<sup>M-1</sup> % M = 1</p>
<p>Hence, A * A<sup>M-2</sup> % M = 1<br>
Or in other words,</p>
<p>A<sup>-1</sup> % M = A<sup>M-2</sup> % M, which is easy (and fast) to find using <a href="http://en.wikipedia.org/wiki/Exponentiation_by_squaring">repeated squaring</a>.</p>
<p>There is one last link I wish to paste to make this complete. Modular inverses can also be found using the <a href="http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm">Extended Euclid's Algorithm</a>. I have only had to use it once or twice among all the problems I ever solved.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/3876/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to gamabunta" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/387/answer/3876/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>15 Nov '12, 18:57</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/83393c46e258fb44adb843ec3a292c94.png" alt="gamabunta&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/387/gamabunta">gamabunta ♦♦</a><br>
    <span class="score" title="2132 karma"><span class="">2.1k</span></span><span title="128 badges"><span class="badge1">●</span><span class="badgecount">128</span></span><span title="183 badges"><span class="silver">●</span><span class="badgecount">183</span></span><span title="169 badges"><span class="bronze">●</span><span class="badgecount">169</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="gamabunta has one accepted answer">14%</span>
    </p>
</div>

    <div class="post-update-info post-update-info-edited">
        <p style="line-height:12px;">
            <a href="http://discuss.codechef.com/revisions/3876/">
                edited
                <strong>15 Nov '12, 22:25</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-3876">
    
        <a name="3883"></a>
        <div class="comment" id="comment-3883">
            <div id="post-3883-score" class="comment-score"></div>
            <div class="comment-text"><p>very nicely written <a href="http://discuss.codechef.com/users/387/gamabunta">@gamabunta</a>. :-)</p></div>
            <div class="comment-info" id="comment-3883-info">
                
                
                
                
                    

                <span class="comment-age">(15 Nov '12, 21:16)</span>
                <a class="comment-user userinfo" href="http://discuss.codechef.com/users/919/shivamrana">shivamrana</a>
                
            </div>
        </div>
    
        <a name="3885"></a>
        <div class="comment" id="comment-3885">
            <div id="post-3885-score" class="comment-score">1</div>
            <div class="comment-text"><p><a href="http://discuss.codechef.com/users/387/gamabunta">@gamabunta</a>: this one is a godd recipe for a tutorial on codechef and topcoder @admins do try to make it a tutorial ..</p></div>
            <div class="comment-info" id="comment-3885-info">
                
                
                
                
                    

                <span class="comment-age">(15 Nov '12, 22:06)</span>
                <a class="comment-user userinfo" href="http://discuss.codechef.com/users/2552/kavishrox">kavishrox</a>
                
            </div>
        </div>
    
        <a name="3913"></a>
        <div class="comment" id="comment-3913">
            <div id="post-3913-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="http://discuss.codechef.com/users/387/gamabunta"></a><a href="http://discuss.codechef.com/users/387/gamabunta">@gamabunta</a>: Firstly Thanks - Well written .</p>

<p>Lucas's Theorem reduces nCr % M to</p>

<p>(n0Cr0 % M) (n1Cr1 % M) ... (nkCrk % M)</p>

<p>Where,</p>

<p>(nknk-1...n0) is the base M representation of n</p>

<p>(rkrk-1...r0) is the base M representation of r</p>

<p>This is only where M is prime .. But in that particular problem M is not prime and so can we reduce it into Base form (And still Lucas Theorem Holds) ? And if we use CRT how can we use it ?</p>

<p>Thanks
Anu :)</p></div>
            <div class="comment-info" id="comment-3913-info">
                
                
                
                
                    

                <span class="comment-age">(17 Nov '12, 22:49)</span>
                <a class="comment-user userinfo" href="http://discuss.codechef.com/users/284/anudeep2011">anudeep2011</a>
                
            </div>
        </div>
    
        <a name="3915"></a>
        <div class="comment" id="comment-3915">
            <div id="post-3915-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="http://discuss.codechef.com/users/387/gamabunta">@gamabunta</a>: yes probably if you explain chinese remainder that would be even more beneficial...I have read it a lot many times but forget it too easily.</p></div>
            <div class="comment-info" id="comment-3915-info">
                
                
                
                
                    

                <span class="comment-age">(18 Nov '12, 00:13)</span>
                <a class="comment-user userinfo" href="http://discuss.codechef.com/users/2552/kavishrox">kavishrox</a>
                
            </div>
        </div>
    
        <a name="39630"></a>
        <div class="comment" id="comment-39630">
            <div id="post-39630-score" class="comment-score">1</div>
            <div class="comment-text"><p>Amazing Detail. Cheers. Just a great feeling seeing someone spend so much time and energy typing this out for others. :)</p>

<p>P.S. <a href="http://discuss.codechef.com/users/284/anudeep2011"></a><a href="http://discuss.codechef.com/users/284/anudeep2011">@anudeep2011</a>:Lucas' Theorem holds true even for prime powers(like 27=3^3) (Called generalized Lucas' theorem)</p></div>
            <div class="comment-info" id="comment-39630-info">
                
                
                
                
                    

                <span class="comment-age">(14 Mar '14, 01:31)</span>
                <a class="comment-user userinfo" href="http://discuss.codechef.com/users/43962/pvaish">pvaish</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-3876" class="comment-tools">
    
    
</div>
<div id="comment-3876-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="3905"></a>
                    <div id="answer-container-3905" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-3905-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/3905/up/" rel="nofollow"> </a>
<div id="post-3905-score" class="post-score" title="current number of votes">
    6
</div>
<a id="post-3905-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/3905/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I agree completely with what <a href="http://discuss.codechef.com/users/2552/kavishrox">@kavishrox</a> wrote...</p>
<p>Admins, would it be possible to have some sort of "pin" feature, so that the "tutorial" like posts wouldn't go down? ;)</p>
<p>It would greatly help newbies and ofc make this community even more respected :D</p>
<p>Bruno</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/3905/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to kuruma" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/2057/answer/3905/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>17 Nov '12, 04:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/default.jpg" alt="kuruma&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/2057/kuruma">kuruma</a><br>
    <span class="score" title="16312 karma"><span class="">16.3k</span></span><span title="72 badges"><span class="badge1">●</span><span class="badgecount">72</span></span><span title="143 badges"><span class="silver">●</span><span class="badgecount">143</span></span><span title="208 badges"><span class="bronze">●</span><span class="badgecount">208</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="kuruma has 33 accepted answers">8%</span>
    </p>
</div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-3905">
    
</div>
<div id="comment-tools-3905" class="comment-tools">
    
    
</div>
<div id="comment-3905-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="3918"></a>
                    <div id="answer-container-3918" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-3918-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/3918/up/" rel="nofollow"> </a>
<div id="post-3918-score" class="post-score" title="current number of votes">
    1
</div>
<a id="post-3918-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/3918/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To take as example :</p>
<p>"142857 = 27 * 11 * 13 * 37. You can find the result of nCr % m for each m = 27, 11, 13, 37."</p>
<p>as 27 is not a prime, i hope we would have to resort to last method of finding all fact[n] and inverse-fact[n] for 27. </p>
<p>So we want nCr and we have x! for all x, WHY do we need inverse factorial ? Is it for (n-r)! and r!. To find inverse of (n-r) and r mod M and then multiply all of their factorials and then find % M.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/3918/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to ashishnegi001" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/5960/answer/3918/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>18 Nov '12, 15:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/default.jpg" alt="ashishnegi001&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/5960/ashishnegi001">ashishnegi001</a><br>
    <span class="score" title="152 karma">152</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="7 badges"><span class="bronze">●</span><span class="badgecount">7</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="ashishnegi001 has no accepted answers">0%</span>
    </p>
</div>

    <div class="post-update-info post-update-info-edited">
        <p style="line-height:12px;">
            <a href="http://discuss.codechef.com/revisions/3918/">
                edited
                <strong>18 Nov '12, 15:10</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-3918">
    
</div>
<div id="comment-tools-3918" class="comment-tools">
    
    
</div>
<div id="comment-3918-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="31692"></a>
                    <div id="answer-container-31692" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-31692-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/31692/up/" rel="nofollow"> </a>
<div id="post-31692-score" class="post-score" title="current number of votes">
    1
</div>
<a id="post-31692-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/31692/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>what if do not want modulo, just ncr which does't fit in even long long?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/31692/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to surajk9035" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/18949/answer/31692/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>15 Dec '13, 13:31</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/2b8b7aac058a003b38c777cc55cb4f2e.JPG" alt="surajk9035&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/18949/surajk9035">surajk9035</a><br>
    <span class="score" title="15 karma">15</span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="surajk9035 has no accepted answers">0%</span>
    </p>
</div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-31692">
    
</div>
<div id="comment-tools-31692" class="comment-tools">
    
    
</div>
<div id="comment-31692-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="3916"></a>
                    <div id="answer-container-3916" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-3916-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/3916/up/" rel="nofollow"> </a>
<div id="post-3916-score" class="post-score" title="current number of votes">
    0
</div>
<a id="post-3916-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/3916/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Would someone pls xplain me what are these "inverse factorials" ??</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/3916/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to dg9_17" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/5832/answer/3916/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>18 Nov '12, 10:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/default.jpg" alt="dg9_17&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/5832/dg9_17">dg9_17</a><br>
    <span class="score" title="31 karma">31</span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="dg9_17 has no accepted answers">0%</span>
    </p>
</div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-3916">
    
</div>
<div id="comment-tools-3916" class="comment-tools">
    
    
</div>
<div id="comment-3916-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="17781"></a>
                    <div id="answer-container-17781" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-17781-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/17781/up/" rel="nofollow"> </a>
<div id="post-17781-score" class="post-score" title="current number of votes">
    0
</div>
<a id="post-17781-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/17781/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>How would you calculate nCr mod 27?</p>
<p>You can't use the inverse modulo here.</p>
<p>and also one can't do this by nCr=(n-1)Cr+(n-1)C(r-1)
given that the minimum space would be just 2 rows but
each of size r which in this case is 1000000000? </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/17781/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to jaskaran_1" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/2167/answer/17781/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>17 Jul '13, 16:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/default.jpg" alt="jaskaran_1&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/2167/jaskaran_1">jaskaran_1</a><br>
    <span class="score" title="525 karma">525</span><span title="23 badges"><span class="badge1">●</span><span class="badgecount">23</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="50 badges"><span class="bronze">●</span><span class="badgecount">50</span></span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="jaskaran_1 has no accepted answers">0%</span>
    </p>
</div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-17781">
    
</div>
<div id="comment-tools-17781" class="comment-tools">
    
    
</div>
<div id="comment-17781-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                    <a name="67395"></a>
                    <div id="answer-container-67395" class="answer ">
                        <table style="width:100%;">
                            <tbody><tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-67395-upvote" title="I like this post (click again to cancel)" class="ajax-command post-vote up " href="http://discuss.codechef.com/vote/67395/up/" rel="nofollow"> </a>
<div id="post-67395-score" class="post-score" title="current number of votes">
    0
</div>
<a id="post-67395-downvote" title="I dont like this post (click again to cancel)" class="ajax-command post-vote down" href="http://discuss.codechef.com/vote/67395/down/" rel="nofollow"> </a>
                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>What is the fastest among all the ways to calculate the value of nCr mod M? where M is definitely prime?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="http://discuss.codechef.com/answer_link/67395/">link</a></span><span class="action-link-separator">|</span><span class="action-link"><a rel="nofollow" title="award points to imujjwalanand" class="ajax-command withprompt  " href="http://discuss.codechef.com/award_points/user/93437/answer/67395/">award points</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class="post-update-info post-update-info-user">
    <p style="line-height:12px;">
        answered
        <strong>04 Apr, 06:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/c7bcfc88fcb11e2238e76def2b19e6d7.jpg" alt="imujjwalanand&#39;s gravatar image">
    <p><a href="http://discuss.codechef.com/users/93437/imujjwalanand">imujjwalanand</a><br>
    <span class="score" title="1 karma">1</span><br>
    
    <span title="Rate of the user&#39;s accepted answers" class="accept_rate">accept rate:</span>
    <span title="imujjwalanand has no accepted answers">0%</span>
    </p>
</div>


                                        </div>
                                        


<div class="comments-container" id="comments-container-67395">
    
</div>
<div id="comment-tools-67395" class="comment-tools">
    
    
</div>
<div id="comment-67395-form-container" class="comment-form-container">
    
</div>
    

                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="http://discuss.codechef.com/questions/3869/answer/" method="post"><div style="display:none;"><input type="hidden" id="csrfmiddlewaretoken" name="csrfmiddlewaretoken" value="937b59130af89f7011b043a36f3c6fe6"></div>
            <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="937b59130af89f7011b043a36f3c6fe6"></div>
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="">
                    <div id="wmd-button-bar" class="wmd-panel"><ul id="wmd-button-row"><li class="wmd-button" id="wmd-bold-button" title="Strong &lt;strong&gt; Ctrl+B" style="background-position: 0px 0px;"></li><li class="wmd-button" id="wmd-italic-button" title="Emphasis &lt;em&gt; Ctrl+I" style="background-position: -20px 0px;"></li><li class="wmd-spacer" id="wmd-spacer1"></li><li class="wmd-button" id="wmd-link-button" title="Hyperlink &lt;a&gt; Ctrl+L" style="background-position: -40px 0px;"></li><li class="wmd-button" id="wmd-quote-button" title="Blockquote &lt;blockquote&gt; Ctrl+Q" style="background-position: -60px 0px;"></li><li class="wmd-button" id="wmd-code-button" title="Code Sample &lt;pre&gt;&lt;code&gt; Ctrl+K" style="background-position: -80px 0px;"></li><li class="wmd-button" id="wmd-image-button" title="Image &lt;img&gt; Ctrl+G" style="background-position: -100px 0px;"></li><li class="wmd-spacer" id="wmd-spacer2"></li><li class="wmd-button" id="wmd-olist-button" title="Numbered List &lt;ol&gt; Ctrl+O" style="background-position: -120px 0px;"></li><li class="wmd-button" id="wmd-ulist-button" title="Bulleted List &lt;ul&gt; Ctrl+U" style="background-position: -140px 0px;"></li><li class="wmd-button" id="wmd-heading-button" title="Heading &lt;h1&gt;/&lt;h2&gt; Ctrl+H" style="background-position: -160px 0px;"></li><li class="wmd-button" id="wmd-hr-button" title="Horizontal Rule &lt;hr&gt; Ctrl+R" style="background-position: -180px 0px;"></li><li class="wmd-spacer" id="wmd-spacer3"></li><li class="wmd-button" id="wmd-undo-button" title="Undo - Ctrl+Z" style="background-position: -200px -20px;"></li><li class="wmd-button" id="wmd-redo-button" title="Redo - Ctrl+Shift+Z" style="background-position: -220px -20px;"></li><li class="wmd-button" id="wmd-help-button" style="background-position: -240px 0px;"><a href="http://wmd-editor.com/" target="_blank" title="WMD website"></a></li></ul></div>
                    <div class="resizable-textarea"><span><textarea rows="10" cols="40" name="text" id="editor" class="processed"></textarea><div class="grippie" style="margin-right: -5px;"></div></span></div>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tbody><tr>
                                <td>
                                    <span id="pre-collapse" title="Toggle the real time Markdown editor preview">[hide preview]</span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input type="checkbox" name="wiki" id="id_wiki">
                                    <span style="font-weight:normal;cursor:help" title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </tbody></table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

	            

                <p><span class="form-error"></span></p>
                
                <input type="button" value="Post Your Answer" class="submit" style="float:left" onclick="submitClicked(event, this.form)">
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><div class="subscription-status"><p>You are not subscribed to this question.</p></div><p><a class="ajax-command sidebar_button subscription_switch" href="http://discuss.codechef.com/subscribe/3869/">
        
            subscribe me
        
    </a></p><p>
        
            (you can adjust your notification settings on your <a href="http://discuss.codechef.com/users/83638/tushar_rishav/subscriptions/">profile</a>)
        
    </p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url(&#39;/m/default/media/images/feed-icon-small.png&#39;);" href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url(&#39;/m/default/media/images/feed-icon-small.png&#39;);" href="http://discuss.codechef.com/questions/3869/best-known-algos-for-calculating-ncr-m?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar" style="display: none;">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
        <li>
			mathemetical formulas in Latex between $ symbol
        </li>
    </ul>
    <p class="info-box-follow-up-links">
        <a href="http://discuss.codechef.com/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>








<div class="boxC">
    <p>
		Tags:
    </p>
    <p class="tags">
        
        	<a href="http://discuss.codechef.com/tags/algorithm/" class="tag-link-algorithm" title="see questions tagged&#39;algorithm&#39;using tags" rel="tag">algorithm</a> <span class="tag-number">×705</span><br>
        
        	<a href="http://discuss.codechef.com/tags/runtime/" class="tag-link-runtime" title="see questions tagged&#39;runtime&#39;using tags" rel="tag">runtime</a> <span class="tag-number">×145</span><br>
        
        	<a href="http://discuss.codechef.com/tags/time/" class="tag-link-time" title="see questions tagged&#39;time&#39;using tags" rel="tag">time</a> <span class="tag-number">×100</span><br>
        
        	<a href="http://discuss.codechef.com/tags/mathematics/" class="tag-link-mathematics" title="see questions tagged&#39;mathematics&#39;using tags" rel="tag">mathematics</a> <span class="tag-number">×40</span><br>
        
    </p>
    <p>
        Asked: <strong title="Nov. 15, 2012, 2:45 p.m.">15 Nov '12, 14:45</strong>
    </p>
    <p>
     	Seen: <strong>20,217 times</strong>
    </p>
    <p>
        Last updated: <strong title="April 4, 2015, 6:25 a.m.">04 Apr, 06:25</strong>
    </p>
</div>





<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="http://discuss.codechef.com/questions/2122/longest-increasing-subsequence" title="I use the programming language; PythonThe problem link; http://www.codechef.com/problems/D2/I implemented a solution that can run in O(n^2logk) where k is the length of the LIS, and n is the length of the sequence, however I get TLE. So I broke down my solution and submitted the algorithm for LIS ">Longest Increasing Subsequence</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/28080/generate-all-the-k-element-subsets-from-a-n-element-set-nk" title="To generate all the k-element subsets from a n-element set (n&amp;gt;k), there is a recursive solution - add a particular element to all the (k-1) element subsets.Follow the same step to get all (k-1) element subsets.I have been unable to put the above idea to code.Could someone help?">Generate all the k-element subsets from a n-element set (n&gt;k).</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/34690/how-to-reduce-compilation-time-in-c" title="I am getting TLE in my program .. using for loops 2 times &amp;amp; it is showing TLE..how to optimize my algorithm?? plz help">how to reduce compilation time in C ??</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/45403/is-there-any-algorithm-for-longest-increasing-subsequence-with-complexity-less-than-on2" title="I just want to know that while using dp for Longest increasing subsequence we get a complexity of O(n^2). Is there any other algorithm by which we can reduce the complexity???Please explain the algo if it exists.">Is there any algorithm for "Longest increasing subsequence" with complexity less than O(n^2)?</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/2157/naive-question-on-time-limit" title="i am curious as to why submitting the same code produces different time taken?? one took 0.08 while the other took 0.00 Solution IDs are 1285481 and 1285480...? Also wat can OM mean???">naive question!! on time limit</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/12882/runtime-error" title="whats wrong in my code http://www.codechef.com/submit/complete/398155-6495--51b22d414fa63plz....help">[closed] runtime error</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/39244/run-time-error" title="when i use my codeblocks to compile my program its working fyn......but when i enter the same code in code chef ...it is showing runtime error....How can i overcome this problem ............THANKS IN ADVANCE">Run time error</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/2178/run-time-error-with-httpwwwcodechefcomproblemsencd04" title="This question was from a codecehef contest Encoder 2010.I saw there also that people complained about runtime error and in the practice problem also people have complained about runtime error.So far nobody has been able to successfully able to solve this problem.I know the logic and implementation">Run time error with http://www.codechef.com/problems/ENCD04</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/32730/runtime-error-why-running-right-on-my-pc" title="#include&amp;lt;stdio.h&amp;gt;void main(){int t,dist,output,j,i;char a[6],b[6];scanf(&quot;%d&quot;,&amp;amp;t);for(i=0;i&amp;lt;t;i++){scanf(&quot;%s&quot;,a);scanf(&quot;%s&quot;,b);scanf(&quot;%d&quot;,&amp;amp;dist);output=60*(10*((int)a[0]-(int)b[0])+((int)a[1]-(int)b[1]))+10*((int)a[3]-(int)b[3])+(int)a[4]-(int)b[4]+dist;printf(&quot;%d &quot;,output">runtime error why running right on my pc</a>
        </p>
        
        <p>
            <a href="http://discuss.codechef.com/questions/12906/ufffhow-many-times-runtime-errord" title="http://www.codechef.com/viewsolution/2204471why is that runtime has suddenly started to pop out in every solutions i am submittingplz...guys...help me up!!!!for the above code.">ufff......how many times runtime error..:D</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            
            <div id="ground">
                
                    <p>

<link rel="stylesheet" type="text/css" href="./Best known algos for calculating nCr % M - CodeChef Discuss_files/cc.css">
</p>
<div id="cc-footer" class="cc-wrapper">
    <div class="cc-inner-wrapper">
        <!-- SECOND NAV -->
        <div class="cc-cols-2">
            <div id="cc-secondary-nav">
                <ul>
                    <!-- <li><a href="http://blog.corp.pw/" target="_blank">.pw Corp Blog</a></li>
                    <li><a href="http://start.pw/" target="_blank">Vision</li> -->
                    <li><a href="http://www.codechef.com/aboutus/">About CodeChef</a></li>
                    <li><a href="http://www.directi.com/" target="_blank">About Directi</a></li>
                    <li><a href="http://www.codechef.com/ceoscorner/">CEO's Corner</a></li>
                    <!-- <li><a href="http://wiki.directi.com/" target="_blank">Wiki</a></li>
                    <li><a href="http://wiki.directi.com/display/corp/Home" target="_blank">About</a></li> -->
                </ul>
                <ul>
                    <li><a href="http://www.codechef.com/campus/">CodeChef Campus Chapters</a></li>
                    <li><a href="http://www.codechef.com/school/">CodeChef For Schools</a></li>
                    <li><a href="http://www.codechef.com/contactus">Contact Us</a></li>
                </ul>
            </div>
            <div id="cc-fineprint">
                <p>© 2009, Directi Group. All Rights Reserved.</p>
                <p><small>Powered by OSQA<br> </small></p>
            </div>
        </div>
        <!-- /SECOND NAV -->
        <!-- LEGAL & COPYRIGHT -->
        <div>
            <div id="cc-sponsor-strip">
                <a href="http://www.directi.com/" target="_blank"><img src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/footer-sponsor-strip.gif" alt="Sponsors" title="Sponsors"></a>
            </div>
        </div>
        <!-- /LEGAL & COPYRIGHT -->
    </div>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Best known algos for calculating nCr % M - CodeChef Discuss_files/ga.js" type="text/javascript"></script>

<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4090524-6");
pageTracker._trackPageview();
} catch(err) {}</script>

<!-- Start Alexa Certify Javascript -->

<script type="text/javascript">
_atrk_opts = { atrk_acct:"q16Cj1a8gN00iz", domain:"codechef.com",dynamic: true};
(function() { var as = document.createElement('script'); as.type = 'text/javascript'; as.async = true; as.src = "https://d31qbv1cthcecs.cloudfront.net/atrk.js"; var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(as, s); })();
</script>

<noscript>&lt;img src="https://d5nxst8fruw4z.cloudfront.net/atrk.gif?account=q16Cj1a8gN00iz" style="display:none" height="1" width="1" alt="" /&gt;</noscript>

<!-- End Alexa Certify Javascript -->
                
            </div>
            
        
        

        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
            
            <a id="close-notify" onclick="notify.close(true)">×</a>
        </div>

    

<!-- end template base_content.html -->
<div id="previewer2" style="display: none;"></div></body></html>